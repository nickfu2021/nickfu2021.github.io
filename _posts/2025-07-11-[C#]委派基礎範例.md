
# C# å§”æ´¾ï¼ˆdelegateï¼‰å­¸ç¿’ç­†è¨˜

## ğŸ§  ä»€éº¼æ˜¯ delegateï¼Ÿ

- delegate æ˜¯å¯ä»¥ã€ŒæŒ‡å‘æ–¹æ³•ã€çš„è®Šæ•¸
- å¯ä»¥å°‡æ–¹æ³•ç•¶ä½œåƒæ•¸å‚³éï¼Œä¹Ÿå¯ä»¥åŸ·è¡Œæ–¹æ³•

### å®£å‘Šèªæ³•ï¼š
```csharp
public delegate int MathOp(int a, int b);
```

---

## âœ… åŸºæœ¬ä½¿ç”¨ç¯„ä¾‹

```csharp
public delegate int MathOp(int a, int b);

public class Test
{
    public int Add(int a, int b) => a + b;

    public void Main()
    {
        MathOp op = Add;
        Console.WriteLine(op(3, 4)); // 7
    }
}
```

---

## ğŸ”„ å‹•æ…‹åˆ‡æ›é‚è¼¯

```csharp
public delegate int MathOp(int a, int b);

public class Test
{
    public int Addition(int a, int b) => a + b;
    public int Subtraction(int a, int b) => a - b;
    public int Multiplication(int a, int b) => a * b;

    public void Main()
    {
        MathOp Calculate = Addition;
        Console.WriteLine(Calculate(3, 4)); // 7

        Calculate = Subtraction;
        Console.WriteLine(Calculate(5, 3)); // 2

        Calculate = Multiplication;
        Console.WriteLine(Calculate(1, 10)); // 10
    }
}
```

---

## ğŸ§ª åŠ å…¥ Lambda è¡¨ç¤ºå¼

```csharp
Calculate = (a, b) => a / b;
Console.WriteLine(Calculate(50, 10)); // 5
```

---

## âœ… delegate èˆ‡ Middleware çš„é—œä¿‚

ASP.NET Core ä¸­çš„ Middleware å¸¸ä½¿ç”¨ `RequestDelegate`ï¼š

```csharp
public class MyMiddleware
{
    private readonly RequestDelegate _next;

    public MyMiddleware(RequestDelegate next)
    {
        _next = next;
    }

    public async Task Invoke(HttpContext context)
    {
        Console.WriteLine("å‰ç½®è™•ç†");

        await _next(context); // åŸ·è¡Œä¸‹ä¸€å±¤ middleware æˆ– Controller

        Console.WriteLine("å¾Œç½®è™•ç†");
    }
}
```

- `_next` æ˜¯ä¸€å€‹å§”æ´¾ï¼ˆ`delegate`ï¼‰ï¼Œä»£è¡¨ä¸‹ä¸€å±¤çš„é‚è¼¯
- åŸ·è¡Œæ™‚æ‰çŸ¥é“ä¸‹ä¸€å±¤æ˜¯ä»€éº¼ â†’ æ›´å½ˆæ€§

---

## ğŸ¯ å°çµ

| åŠŸèƒ½ | å¥½è™• |
|------|------|
| æ–¹æ³•å¯å‚³é | å¯ä»¥æŠŠé‚è¼¯äº¤çµ¦å¤–éƒ¨æ±ºå®š |
| åŸ·è¡Œæ™‚æ±ºå®šé‚è¼¯ | æ”¯æ´æ›´å‹•æ…‹çš„æµç¨‹æ§åˆ¶ |
| é‹ç”¨ç¯„åœå»£ | middlewareã€äº‹ä»¶ã€ç­–ç•¥æ¨¡å¼éƒ½æœƒç”¨åˆ° |

