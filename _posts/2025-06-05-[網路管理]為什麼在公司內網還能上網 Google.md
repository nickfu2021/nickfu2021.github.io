# 🧠 為什麼我在公司內網還能上 Google？（公司 Proxy 與內網上網邏輯解析）

## ❓ 問題原文
> 我明明在公司內網，為什麼可以用公司電腦的瀏覽器開得了 `www.google.com`？不是應該不能連外網嗎？

---

## ✅ 答案概要

你可以開 Google，**不是因為你直接連上公網**，而是因為：
👉 公司設置了「對外通道」，讓你透過特定設備轉送流量到外網。

---

## 🔄 比喻：你不能自己出門，但有人幫你代買

- 你在「公司內部」＝ 在內網裡面，不能直接走出門
- 你想上 Google，就像「你想去便利商店」
- 你把需求交給櫃台（Proxy 或 Firewall），他幫你出去處理
- 回來後把結果交給你

---

## 🔍 技術解釋

公司幫你打通對外網路的方式通常有三種：

| 功能 | 說明 |
|------|------|
| 🧱 **Firewall + NAT** | 幫你把內部 IP → 換成 公網 IP，才能出去（像翻譯護照） |
| 🔁 **Transparent Proxy** | 自動攔截封包並幫你代送請求（無須本機設定） |
| 🌐 **手動 HTTP Proxy** | 如 `proxy.aiontech.com:3128`，本機需設定才能使用 |

---

## 📶 流程圖邏輯：

```text
你電腦（10.x.x.x 內部 IP）
      │
      ▼
   公司內網（Switch / Router）
      │
      ▼
[ 防火牆 / Proxy / NAT ]
      │
      ▼
   公網（Google、YouTube 等網站）
```

---

## ✅ 你的實際狀況：

| 狀況 | 說明 |
|------|------|
| 你在內網 | 沒錯，IP 是 10.x.x.x，屬於私有網段 |
| 能開 Google | 公司幫你設好了 NAT 或 Proxy |
| 本機 Proxy 關閉 | 可能公司改用「透明 Proxy」，你不用手動設定也能上網 |

---

## 🔐 為什麼公司這樣設計？

- ✅ **安全控管**：可以記錄誰連了哪些網站
- ✅ **易於維護**：不用每台電腦都手動設定
- ✅ **避免洩露內部架構**：讓外部看不到內部 IP

---

## 🌐 補充：什麼是 NAT？為什麼大家都看起來像同一個對外 IP？

### 🔧 NAT 是什麼？
NAT 全名是 **Network Address Translation（網路位址轉換）**，讓內部 IP 能「翻譯成」公網 IP 對外上網。

### 🧠 白話比喻：
你在公司裡（內網 IP 是 10.x.x.x），但出去 Google 是透過一個對外出口（像總機）。外部網站只看到你來自 `220.229.248.253`（公司 NAT 公網 IP），看不到你是內部哪一台電腦。

---

## 🔁 多人共用一個公網 IP（PAT）

這種情況叫做：
### **PAT（Port Address Translation）**
也叫 NAT overload 或多對一 NAT，讓所有內部設備共用同一個公網 IP。

| 內部來源            | NAT 裝置轉換後               |
|---------------------|------------------------------|
| 10.200.1.10:51521   | 220.229.248.253:10001        |
| 10.200.1.11:51522   | 220.229.248.253:10002        |

---

## 📶 圖示邏輯：

```text
公司內部網路：
  ┌────────────┬────────────┬────────────┐
  │10.200.1.10 │10.200.1.11 │10.200.1.12 │ ← 員工電腦
  └────────────┴────────────┴────────────┘
         │        │         │
         ▼        ▼         ▼
        [ NAT 防火牆或路由器 ]
                │
                ▼
         公網 IP：220.229.248.253
                │
                ▼
            Internet（Google 等）
```

---

## ✅ 驗證方式：大家是不是都用同一個 NAT IP？

你可以請其他同事上這個網站：
👉 [https://whatismyipaddress.com](https://whatismyipaddress.com)

若大家看到的對外 IP 都是 `220.229.248.253`，就代表：
➡️ 全公司都是透過 NAT 裝置共用這個出口上網。

---

## 🔁 補充：什麼是反向 Proxy？

### 🧠 比喻方式說明：

| 模式 | 比喻角色 | 說明 |
|------|----------|------|
| ✅ 正向 Proxy | 你請公司櫃台幫你出門買東西 | 你是內部員工，要查 Google，由櫃台幫你出去處理 |
| ✅ 反向 Proxy | 客戶來公司，櫃台幫忙分配處理窗口 | 客戶來訪問你公司網站，請求先被櫃台接住，分派給內部伺服器處理 |

### 🏢 實際情境比喻：

你公司有三個伺服器，但對外只開一個門口（反向 Proxy）  
訪客（用戶）來公司，他們不知道裡面有誰，只會和櫃台對話  
櫃台（反向 Proxy）會根據請求，把訪客導向不同的內部伺服器處理

---

## 📶 圖示邏輯（反向 Proxy）

```text
使用者 → [ 櫃台 Reverse Proxy ]
                 │
   ┌─────────────┼─────────────┐
   ▼             ▼             ▼
 Server A      Server B      Server C
(主頁)       (會員中心)     (圖片伺服器)
```

---

## ✅ 反向 Proxy 的功能：

| 功能 | 說明 |
|------|------|
| 🎯 載入平衡（Load Balancing） | 分配流量，避免單一伺服器過載 |
| 🔐 隱藏內部架構 | 外部不會知道內部有幾台機器 |
| 🧱 增加安全性 | 攔截惡意請求、防火牆功能 |
| 💾 快取靜態資源 | 加快圖片/JS 載入速度 |
| 📈 日誌記錄 | 記錄使用者請求與分析流量 |

---

> ✅ 總結：  
> 正向 Proxy 是「幫你出去」；反向 Proxy 是「幫你接客人，再決定找誰處理」。